@model Langben.App.Models.PREPARE_SCHEMEShow
@{
    Layout = "~/Views/Shared/AppCreate.cshtml";
}

<fieldset>
    <input class="a2 f2" type="button" onclick="javascript: window.location.href = '/VJIANDINGRENWU/Index';" value="返回" />
    <div class="input_search">
        <div class="input_search-label">
            证书编号：
        </div>
        <div class="input_search-field">
            @if (Model.REPORTNUMBER != null)
            {
                <label>
                    @Model.REPORTNUMBER
                </label>
            }
            <input type="hidden" name="REPORTNUMBER" value="@Model.REPORTNUMBER" />
        </div>
    </div>
    <div style="width:800px">
        <b>试验方案制定</b>
        <div class="clearfix"></div>
        <div class="input_search">
            <div class="input_search-label">
                <a class="anUnderLine" onclick="showModalOnly('SCHEMEID', '../../SCHEME/Selected');">
                    选择方案模板
                </a>：
            </div>
            <div class="input_search-field">
                <div id="checkSCHEMEID">
                </div>
                @Html.HiddenFor(model => model.SCHEMEID)
            </div>
        </div>
        
        


        <div class="clearfix"></div>
        <b>被检器具主要参数</b>
        <div class="clearfix"></div>
        <div class="input_search">
            <div class="input_search-label">
                <span style="color:#F00">*</span>器具名称：
            </div>
            <div class="input_search-field">
                <input type="text" readonly="readonly" value="@Model.APPLIANCE_DETAIL_INFORMATIONShows.APPLIANCE_NAME" disabled="disabled" />
            </div>
        </div><br />
        <div class="input_search">
            <div class="input_search-label">
                <span style="color:#F00">*</span>器具型号：
            </div>
            <div class="input_search-field">
                <input type="text" readonly="readonly" value="@Model.APPLIANCE_DETAIL_INFORMATIONShows.VERSION" disabled="disabled" />
            </div>
        </div><br />
        <div class="input_search">
            <div class="input_search-label">
                器具规格：
            </div>
            <div class="input_search-field">
                <input type="text" readonly="readonly" value="@Model.APPLIANCE_DETAIL_INFORMATIONShows.FORMAT" disabled="disabled" />
            </div>
        </div><br />
        <div class="input_search">
            <div class="input_search-label">
                <span style="color:#F00">*</span>出厂编号：
            </div>
            <div class="input_search-field">
                <input type="text" readonly="readonly" value="@Model.APPLIANCE_DETAIL_INFORMATIONShows.FACTORY_NUM" disabled="disabled" />
            </div>
        </div><br />
        <div class="input_search">
            <div class="input_search-label">
                <span style="color:#F00">*</span>准确度等级：
            </div>
            <div class="input_search-field">
                <input type="text" name="ACCURACY_GRADE" id="ACCURACY_GRADE" value="@Model.ACCURACY_GRADE" />
            </div>
        </div><br />
        <div class="input_search">
            <div class="input_search-label">
                <span style="color:#F00">*</span>制造单位：
            </div>
            <div class="input_search-field">
                <input type="text" readonly="readonly" value="@Model.APPLIANCE_DETAIL_INFORMATIONShows.MAKE_ORGANIZATION" disabled="disabled" />
            </div>
        </div><br />
        @if (ViewBag.UNDERTAKE_LABORATORY_NAME == Common.LABORATORYNAME.电能.ToString())
        {
            <div class="input_search" id="diannengmaicong">
                <div class="input_search-label">
                    脉冲常数：
                </div>
                <div class="input_search-field">
                    <input type="text" name="PULSE_CONSTANT" id="PULSE_CONSTANT" value="@Model.ACCURACY_GRADE" />
                </div>
            </div><br />
        }
        @if (ViewBag.UNDERTAKE_LABORATORY_NAME == Common.LABORATORYNAME.电能.ToString() || ViewBag.UNDERTAKE_LABORATORY_NAME == Common.LABORATORYNAME.互感器.ToString())
        {
            <div class="input_search" id="diannengeding">
                <div class="input_search-label">
                    额定频率：
                </div>
                @if (Model.RATED_FREQUENCY != null)
                {
                    <div class="input_search-field">
                        <input type="text" name="RATED_FREQUENCY" id="RATED_FREQUENCY" value="@Model.RATED_FREQUENCY" />Hz
                    </div>
                }
                else
                {
                    <div class="input_search-field">
                        <input type="text" name="RATED_FREQUENCY" id="RATED_FREQUENCY" value="50" />Hz
                    </div>
                }

            </div><br />
        }
        @*<div class="input_search" id="huganqiwaijie">
                <div class="input_search-label">
                    外接电阻值：
                </div>
                <div class="input_search-field">
                    <input type="text" name="EXTERNAL_RESITANCE_VALUE" id="EXTERNAL_RESITANCE_VALUE" />
                </div>
            </div><div class="clearfix"></div>*@
        <b>其他信息</b><br style="clear:both;" />
        <div class="input_search">
            <div class="input_search-label">
                环境温度：
            </div>
            <div class="input_search-field">
                <input type="text" value="@Model.TEMPERATURE" />℃
            </div>
        </div><br />
        <div class="input_search">
            <div class="input_search-label">
                相对湿度：
            </div>
            <div class="input_search-field">
                <input type="text" value="@Model.HUMIDITY" />％
            </div>
        </div><br />
        <div class="input_search">
            @if (ViewBag.CERTIFICATE_CATEGORY == "检定")
            {
                <div class="input_search-label">
                    <span style='color:#F00'>*</span>检定地点：
                </div>
            }
            else if (ViewBag.CERTIFICATE_CATEGORY == "校准")
            {
                <div class="input_search-label">
                    <span style='color:#F00'>*</span>校准地点：
                </div>
            }
            <div class="input_search-field">
                <input type="text" value="@Model.CHECK_PLACE" />
            </div>
        </div><br />
        <div class="input_search">
            @*检定日期*@
            @if (ViewBag.CERTIFICATE_CATEGORY == "检定")
            {
                <div class="input_search-label">
                    <span style='color:#F00'>*</span>检定日期：
                </div>
            }
            else if (ViewBag.CERTIFICATE_CATEGORY == "校准")
            {
                <div class="input_search-label">
                    <span style='color:#F00'>*</span>校准日期：
                </div>
            }
            <div class="input_search-field">
                <input type="text" value="@Model.CALIBRATION_DATE" id="CALIBRATION_DATE" />
            </div>
        </div><br />
        <div class="input_search">
            <div class="input_search-label">
                <span style='color:#F00'>*</span>核验员：
            </div>
            <div class="input_search-field">
                @Html.DropDownList("DETECTERID", Models.SysPersonModels.GetMyName(), "请选择", new { id = "DETECTERID", @class = "easyui-combobox" })
            </div>
        </div><br style="clear:both;" />
        <table id="biaozhuizhuangzi"></table><br style="clear:both;" />
        <table id="biaozhuiqi"></table><br style="clear:both;" />
        @*弹窗*@
        <div id="w" class="easyui-window" title="Window Layout" data-options="iconCls:'icon-save'" style="width:700px;height:400px;padding:5px;">
            <div class="easyui-layout" data-options="fit:true">
                @*<div data-options="region:'east',split:true" style="width:100%;" id="tanchuandivzhuangzi">
                        <table id="zhuangzitianjia" style="display:none"></table><br style="clear:both;" />
                        <table id="qitianjia" style="display:none"></table><br style="clear:both;" />
                    </div>*@
                <div style="width:100%;display:none" id="tanchuandivzhuangzi">
                    <table id="zhuangzitianjia"></table>
                </div>
                <div style="width:100%;display:none" id="tanchuandivqi">
                    <table id="qitianjia"></table>
                </div>
                @*<div data-options="region:'center'" style="padding:10px;display:none;width:100%" id="tanchuandivqi">
                        <table id="qitianjia"></table><br style="clear:both;" />
                    </div>*@
                <div data-options="region:'south',border:false" style="text-align:right;padding:5px 0 0;">
                    <a class="easyui-linkbutton" data-options="iconCls:'icon-ok'" href="javascript:void(0)" onclick="javascript:alert('ok')" style="width:80px">Ok</a>
                    <a class="easyui-linkbutton" data-options="iconCls:'icon-cancel'" href="javascript:void(0)" onclick="javascript:alert('cancel')" style="width:80px">Cancel</a>
                </div>
            </div>
        </div>
        @*************************@
        <input type="button" value="下一步" />
        <input type="button" value="保存下一步" />
    </div>
</fieldset>
<script type="text/javascript">
    $(function () {
        //添加日期控件
        $("#CALIBRATION_DATE").datebox({ "required": true });//true为必填项
        //核验员数据加载
        $("#DETECTERID").combobox('select', '@Model.DETECTERID');
        //************************
        $('#w').window('close')

        if ("@ViewBag.UNDERTAKE_LABORATORY_NAME" == "@Common.LABORATORYNAME.电能.ToString()") {
            //标准装置绑定
            $('#biaozhuizhuangzi').datagrid({
                title: '标准装置', //列表的标题
                iconCls: 'icon-site',
                width: 'auto',
                height: 'auto',
                //nowrap: false,
                striped: true,
                collapsible: true,
                url: '../VJIANDINGRENWU/GetData', //获取数据的url
                sortName: 'ID',
                sortOrder: 'desc',
                idField: 'ID',
                toolbar: [
                     {
                         text: '+',
                         iconCls: 'icon-search',
                         handler: function () {
                             return biaozhunzhuangzi();
                         }
                     },
                      {
                          text: '删除',
                          iconCls: 'icon-search',
                          handler: function () {
                              return lingqu();
                          }
                      }
                ],
                columns: [[

                        { field: 'ID', title: '名称', width: 64 }
                        , { field: 'ORDER_NUMBER', title: '测量范围', width: 64 }
                ]],
            })
        }

        //标准器绑定
        $('#biaozhuiqi').datagrid({
            title: '标准器', //列表的标题
            iconCls: 'icon-site',
            width: 'auto',
            height: 'auto',
            //nowrap: false,
            striped: true,
            collapsible: true,
            //url: '../VJIANDINGRENWU/GetData', //获取数据的url
            sortName: 'ID',
            sortOrder: 'desc',
            idField: 'ID',
            toolbar: [
                 {
                     text: '+',
                     iconCls: 'icon-search',
                     handler: function () {
                         return biaozhunqi();
                     }
                 },
                  {
                      text: '删除',
                      iconCls: 'icon-search',
                      handler: function () {
                          return lingqu();
                      }
                  }
            ],
            columns: [[

                    { field: 'ID', title: '名称', width: 64 }
					, { field: 'ORDER_NUMBER', title: '测量范围', width: 64 }
            ]],
        })

    });
    //标准器的选择
    function biaozhunqi() {
        $('#w').window('close')
        //标准器弹窗页面添加
        $('#qitianjia').datagrid({
            title: '计量标准器列表', //列表的标题
            iconCls: 'icon-site',
            width: 'auto',
            height: 'auto',
            //nowrap: false,
            striped: true,
            collapsible: true,
            //url: '../VJIANDINGRENWU/GetData', //获取数据的url
            sortName: 'ID',
            sortOrder: 'desc',
            idField: 'ID',
            columns: [[
                { field: 'ID', title: '类别', width: 64 }
                , { field: 'ID', title: '名称', width: 64 }
				, { field: 'ORDER_NUMBER', title: '出厂编号', width: 64 }
                , { field: 'ORDER_NUMBER', title: '测量范围', width: 64 }
                , { field: 'ORDER_NUMBER', title: '不确定度/准确度等级/最大允许误差', width: 64 }
                , { field: 'ORDER_NUMBER', title: '检定/校准证书编号', width: 64 }
                , { field: 'ORDER_NUMBER', title: '有效期至', width: 64 }
            ]],
        })
        $("#tanchuandivqi").show();
        $('#w').window('open');
        $("#tanchuandivzhuangzi").hide();
    }
    //标准装置选择
    function biaozhunzhuangzi() {
        $('#w').window('close')
        //标准器弹窗页面添加
        $('#zhuangzitianjia').datagrid({
            title: '计量标准装置列表', //列表的标题
            iconCls: 'icon-site',
            width: 'auto',
            height: 'auto',
            //nowrap: false,
            striped: true,
            collapsible: true,
            //url: '../VJIANDINGRENWU/GetData', //获取数据的url
            sortName: 'ID',
            sortOrder: 'desc',
            idField: 'ID',
            columns: [[
                 { field: 'ID', title: '名称', width: 64 }
                , { field: 'ORDER_NUMBER', title: '测量范围', width: 64 }
                , { field: 'ORDER_NUMBER', title: '不确定度/准确度等级/最大允许误差', width: 64 }
                , { field: 'ORDER_NUMBER', title: '计量标准证书编号', width: 64 }
                , { field: 'ORDER_NUMBER', title: '有效期至', width: 64 }
            ]],
        })
        $("#tanchuandivzhuangzi").show();
        $('#w').window('open', {
            collapsible: false,
            minimizable: false,
            maximizable: false
        });
        $("#tanchuandivqi").hide();
    }
</script>

