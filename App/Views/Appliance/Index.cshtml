@model Langben.DAL.ORDER_TASK_INFORMATION
@{
    Layout = "~/Views/Shared/AppCreate.cshtml";
}
@using Common
@using Models

@*表格*@
<script src="~/Scripts/jquery.edatagrid.js"></script>

@section HeadContent {

    创建

}
<div>
    条形码：@Html.Editor("BAR_CODE_NUM", new { })
    出厂编号：@Html.Editor("FACTORY_NUM")
    型号：@Html.Editor("VERSION")
    器具名称：@Html.Editor("APPLIANCE_NAME")
</div>
<br style="clear:both;" />

<input type="button" onclick="seng()" value="查询" />
<script type="text/javascript">
    //委托单保存
    function ajaxFrom(form, url) {
        $.ajax({
            url: url,
            type: "Post",
            data: $(form).serialize(),
            dataType: "json",

            success: function (data) {
                if (data.Code == 0) { $.messager.alert('操作提示', data.Message, 'info'); }
                else {
                    $("#hiddenid").val(data.Id);
                    if ($.messager) {
                        $.messager.defaults.ok = '继续';
                        $.messager.defaults.cancel = '返回';

                        $.messager.confirm('操作提示', data.Message, function (r) {
                            if (!r) {
                                window.location.href = 'javascript:history.go(-1)';
                            }
                        });
                    }
                }


            }
        });

    }

    //删除
    function flexiDelete() {
        $('#ApplianceDate').edatagrid('destroyRow')
    }
    //查询
    function seng() {
        //器具信息绑定
        var search = "";
        search = "BAR_CODE_NUM" + "@@" + $("#BAR_CODE_NUM").val() + "^" + "FACTORY_NUM" + "@@" + $("#FACTORY_NUM").val() + "^" + "VERSION" + "@@" + $("#VERSION").val() + "^" + "APPLIANCE_NAME" + "@@" + $("#APPLIANCE_NAME").val() + "^"
        $('#ApplianceDate').edatagrid({ url: '/api/APPLIANCE_DETAIL_INFORMATIONApi/PostDataByID/' + search });

    }
    $(function () {
        $.extend($.fn.datagrid.defaults.editors, {
            text: {
                init: function (container, options) {
                    var input = $('<input type="text" class="datagrid-editable-input">').appendTo(container);
                    return input;
                },
                destroy: function (target) {
                    $(target).remove();
                },
                getValue: function (target) {
                    return $(target).val();
                },
                setValue: function (target, value) {
                    $(target).val(value);
                },
                resize: function (target, width) {
                    $(target)._outerWidth(width);
                }
            }
        });

        $("form").submit(function (form) {
            if (form.result) {
                ajaxFrom(this, this.action);
            }
            return false;
        });
        //新增
        function flexiInsert() {
            $('#ApplianceDate').edatagrid('addRow', {

            })
            // $("#xu").val();
        }
        var editFlag = undefined;//设置一个编辑标记
        var url = null;
        var Address = [{ "value": "是", "text": "是" }, { "value": "否", "text": "否" }];

        //保存
        function flexiSave() {
            $('#ApplianceDate').edatagrid('saveRow')
            debugger;
            var datasdf = $('#ApplianceDate').edatagrid('getRows');

            //// $("#xu").val();
        }

        $('#ApplianceDate').edatagrid({


            //saveUrl: "/api/APPLIANCE_DETAIL_INFORMATIONApi/Post/1",
            //updateUrl: "/api/APPLIANCE_DETAIL_INFORMATIONApi/Put",
            // destroyUrl: "/api/APPLIANCE_DETAIL_INFORMATIONApi/Delete",
            toolbar: [
             {
                 text: '新增',
                 iconCls: 'icon-add',
                 handler: function () {
                     return flexiInsert();
                 }
             }, {
                 text: '复制新增',
                 iconCls: 'icon-add',
                 handler: function () {
                     return flexiCreate();
                 }
             },
               {
                   text: '保存',
                   iconCls: 'icon-add',
                   handler: function () {
                       return flexiSave();
                   }
               }, {
                   text: '删除',
                   iconCls: 'icon-remove',
                   handler: function () {
                       return flexiDelete();
                   }
               }],
            columns: [[
             {
                 field: 'ID', title: '选中', width: 35, formatter:
                   function (value, row, index) { return '<input id=\"' + row.ID + '\" type=\"checkbox\">'; }
             }
           , {
               field: 'APPLIANCE_NAME', title: '器具名称', width: 135, editor: {
                   type: 'validatebox', options: {
                       precision: 1,
                       required: true,
                       missingMessage: '必填'
                   }
               }
           }
           , {
               field: 'VERSION', title: '型号', width: 65, editor: {
                   type: 'validatebox', options: {
                   
                       required: true,
                       missingMessage: '必填'
                   }
               }
           }, {
               field: 'NUM', title: '数量', width: 35, editor: {
                   type: 'validatebox', options: {
                       required: true,
                       missingMessage: '必填'
                   }
               }
           }, {
               field: 'APPEARANCE_STATUS', title: '外观状态', width: 65, editor: {
                   type: 'text', setValue: function (target, value) {
                       debugger;
                       $(target).val('value');
                   }, options: {
                      
                   }
               }
           }
           , { field: 'FORMAT', title: '规格', width: 65, editor: 'text' }
           , { field: 'FACTORY_NUM', title: '出厂编号', width: 65, editor: 'text' }

           , { field: 'ATTACHMENT', title: '附件', width: 135, editor: 'text' }

           , { field: 'MAKE_ORGANIZATION', title: '制造单位', width: 65, editor: 'text' }
           , {
               field: 'UNDERTAKE_LABORATORYID', title: '承接实验室', width: 135, editor: {
                   type: 'combobox',
                   options: {
                       multiple: true,
                       data: [{ value: '电能', text: '电能' }, { value: '指示仪表', text: '指示仪表' }, { value: '数字仪表', text: '数字仪表' }, { value: '互感器仪表', text: '互感器仪表' }],
                       panelHeight: 'auto'
                   }
               }
           }
           , {
               field: 'APPLIANCE_RECIVE', title: '器具接收', width: 65, editor: {
                   type: 'combobox', options: { data: [{ value: '是', text: '是' }, { value: '否', text: '否' }], panelHeight: 'auto' }
               }
           }
           , { field: 'REMARKS', title: '备注', width: 135, editor: 'text' }
            ]]

        });

    });
    //

</script>
<input type="checkbox" name="abc" value="1" />
<select id="cc" data-options="multiple:true, multiline:true" class="easyui-combobox" name="dept" style="width:200px;"><option value="aa">aitem1</option><option>bitem2</option><option>bitem3</option><option>ditem4</option><option>eitem5</option></select>
@*百度模式输入显示下拉框*@
@*<link href="~/Content/jquery-ui-1.10.1.custom.min.css" rel="stylesheet" />
    <script src="~/Scripts/jquery-ui-1.10.1.custom.min.js"></script>*@
@*<script type="text/javascript">
        //输入显示下拉框
        //出厂编号
        $("#FACTORY_NUM").ajaxStop();
        $("#FACTORY_NUM").autocomplete({
            source: "../Appliance/SearchAutoComplete/FACTORY_NUM",
            minLength: 1,//键入的字数
            select: function (event, ui) {
                $("#BAR_CODE_NUM").val(ui.item.BAR_CODE_NUM);//条形码
                $("#VERSION").val(ui.item.VERSION);//型号
                $("#APPLIANCE_NAME").val(ui.item.APPLIANCE_NAME);//器具名称
            }
        });
        //型号
        $("#VERSION").ajaxStop();
        $("#VERSION").autocomplete({
            source: "../Appliance/SearchAutoComplete/VERSION",
            minLength: 1,//键入的字数
            select: function (event, ui) {
                $("#BAR_CODE_NUM").val(ui.item.BAR_CODE_NUM);//条形码
                $("#FACTORY_NUM").val(ui.item.FACTORY_NUM);//出厂编号
                $("#APPLIANCE_NAME").val(ui.item.APPLIANCE_NAME);//器具名称
            }
        });
        //器具名称
        $("#APPLIANCE_NAME").ajaxStop();
        $("#APPLIANCE_NAME").autocomplete({
            source: "../Appliance/SearchAutoComplete/APPLIANCE_NAME",
            minLength: 1,//键入的字数
            select: function (event, ui) {
                $("#BAR_CODE_NUM").val(ui.item.BAR_CODE_NUM);//条形码
                $("#VERSION").val(ui.item.VERSION);//型号
                $("#FACTORY_NUM").val(ui.item.FACTORY_NUM);//出厂编号
            }
        });
    </script>*@

<div class="bigdiv">
    @*@using (Html.BeginForm("", "api/ORDER_TASK_INFORMATIONApi/Post"))
        {

            <div class="editor-label">
                @Html.LabelFor(model => model.ACCEPT_ORGNIZATION)：
            </div>
            <div class="editor-field">
                @Html.DropDownList("ACCEPT_ORGNIZATION", Models.SysFieldModels.GetSysField("Appliance", "ACCEPT_ORGNIZATION"), "请选择", new { id = "ACCEPT_ORGNIZATION_String" })
            </div>
            <div class="editor-label">
                @Html.LabelFor(model => model.INSPECTION_ENTERPRISE)：
            </div>
            <div class="editor-field">
                @Html.EditorFor(model => model.INSPECTION_ENTERPRISE)
                @Html.ValidationMessageFor(model => model.INSPECTION_ENTERPRISE)
            </div>
            <div class="editor-label">
                @Html.LabelFor(model => model.INSPECTION_ENTERPRISE_ADDRESS)：
            </div>
            <div class="editor-field">
                @Html.EditorFor(model => model.INSPECTION_ENTERPRISE_ADDRESS)
                @Html.ValidationMessageFor(model => model.INSPECTION_ENTERPRISE_ADDRESS)
            </div>
            <div class="editor-label">
                @Html.LabelFor(model => model.INSPECTION_ENTERPRISE_POST)：
            </div>
            <div class="editor-field">
                @Html.EditorFor(model => model.INSPECTION_ENTERPRISE_POST)
                @Html.ValidationMessageFor(model => model.INSPECTION_ENTERPRISE_POST)
            </div>
            <div class="editor-label">
                @Html.LabelFor(model => model.CONTACTS)：
            </div>
            <div class="editor-field">
                @Html.EditorFor(model => model.CONTACTS)
                @Html.ValidationMessageFor(model => model.CONTACTS)
            </div>
            <div class="editor-label">
                @Html.LabelFor(model => model.CONTACT_PHONE)：
            </div>
            <div class="editor-field">
                @Html.EditorFor(model => model.CONTACT_PHONE)
                @Html.ValidationMessageFor(model => model.CONTACT_PHONE)
            </div>
            <div class="editor-label">
                @Html.LabelFor(model => model.FAX)：
            </div>
            <div class="editor-field">
                @Html.EditorFor(model => model.FAX)
                @Html.ValidationMessageFor(model => model.FAX)
            </div>
            <div class="editor-label">
                @Html.LabelFor(model => model.CERTIFICATE_ENTERPRISE)：
            </div>
            <div class="editor-field">
                @Html.EditorFor(model => model.CERTIFICATE_ENTERPRISE)
                @Html.ValidationMessageFor(model => model.CERTIFICATE_ENTERPRISE)
            </div>
            <div class="editor-label">
                @Html.LabelFor(model => model.CERTIFICATE_ENTERPRISE_ADDRESS)：
            </div>
            <div class="editor-field">
                @Html.EditorFor(model => model.CERTIFICATE_ENTERPRISE_ADDRESS)
                @Html.ValidationMessageFor(model => model.CERTIFICATE_ENTERPRISE_ADDRESS)
            </div>
            <div class="editor-label">
                @Html.LabelFor(model => model.CERTIFICATE_ENTERPRISE_POST)：
            </div>
            <div class="editor-field">
                @Html.EditorFor(model => model.CERTIFICATE_ENTERPRISE_POST)
                @Html.ValidationMessageFor(model => model.CERTIFICATE_ENTERPRISE_POST)
            </div>
            <div class="editor-label">
                @Html.LabelFor(model => model.CONTACTS2)：
            </div>
            <div class="editor-field">
                @Html.EditorFor(model => model.CONTACTS2)
                @Html.ValidationMessageFor(model => model.CONTACTS2)
            </div>
            <div class="editor-label">
                @Html.LabelFor(model => model.CONTACT_PHONE2)：
            </div>
            <div class="editor-field">
                @Html.EditorFor(model => model.CONTACT_PHONE2)
                @Html.ValidationMessageFor(model => model.CONTACT_PHONE2)
            </div>
            <div class="editor-label">
                @Html.LabelFor(model => model.FAX2)：
            </div>
            <div class="editor-field">
                @Html.EditorFor(model => model.FAX2)
                @Html.ValidationMessageFor(model => model.FAX2)
            </div>
            <div class="editor-label">
                @Html.LabelFor(model => model.CUSTOMER_SPECIFIC_REQUIREMENTS)：
            </div>
            <div class="editor-field">
                @Html.EditorFor(model => model.CUSTOMER_SPECIFIC_REQUIREMENTS)
                @Html.ValidationMessageFor(model => model.CUSTOMER_SPECIFIC_REQUIREMENTS)
            </div>
            <br style="clear:both;" />
            <input type="submit" value="保存" />
        }*@
    <br style="clear:both;" />
    <input type="hidden" value="123" id="hiddenid" />
    <table id="ApplianceDate"
           singleSelect="true"></table>
</div>
